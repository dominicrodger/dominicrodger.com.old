<!DOCTYPE html>
<html lang="en">
<head>
        <title>Starting Over</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
        <link href="http://dominicrodger.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="dominicrodger.com Atom Feed" />
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

        <header id="banner" class="body">
                <h1><a href=".">dominicrodger.com </a></h1>
                <nav><ul>
                
                
                
                    <li><a href="./pages/about-me.html">about me</a></li>
                
                
                
                    <li class="active"><a href="./category/code.html">code</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                
<section id="content" class="body">    
<article>
        <header> <h1 class="entry-title"><a href=""
        rel="bookmark" title="Permalink to Starting Over">Starting Over</a></h1> 
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="dominicrodger">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
 </header>
        <div class="entry-content">
        <footer class="post-info">
        <abbr class="published" title="2012-04-07T00:00:00">
                Saturday 07 April 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/dominic-rodger.html">Dominic Rodger</a>
        </address>
        
<p>In <a href="./category/code.html">code</a>. </p>



</footer><!-- /.post-info -->
        <h1>Please sir, can I start again?</h1>
<p>Every once in a while, I want to start again.</p>
<p>I currently have 6 different sites using Kal&#233;o<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. The code is stored in
a private git repository, and synced out to 6 different places every time I
need to make a change.</p>
<p>Most these changes are fairly simple, and upgrading each site looks roughly
like this:</p>
<div class="codehilite"><pre><span class="nb">source </span>myvirtualenv/bin/activate
git pull
python manage.py migrate
python manage.py collectstatic
apache2/bin/restart
<span class="c"># profit!</span>
</pre></div>


<p>Since this is all eminently scriptable, it's scripted, and I've got a quick
Python script on my desktop that SSHs to each site in turn, and updates them.</p>
<p>The problem is, not every upgrade is that simple<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>. In practice, I end up
having to run a few different commands - generally when I want to install new
dependencies<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>.</p>
<h1>What I should have done</h1>
<p>Kal&#233;o is built with <a href="https://www.djangoproject.com/" title="Read about Django, a Python web framework">Django</a>, which has a
really nice system for <a href="https://docs.djangoproject.com/en/dev/ref/contrib/sites/" title="The Django Sites framework">dealing with multiple sites</a>.</p>
<p>I should have used that, but back <a href="http://stackoverflow.com/questions/744866/reverse-not-found-sending-request-context-in-from-templates" title="My first ever Django question on Stack Overflow">when I started</a> in 2009 I
was just building something for my Church (and learning Django at the same
time), and it didn't occur to me that I might want to re-use it.</p>
<h1>What I want to do</h1>
<p>So now I have 6 different installations of Kal&#233;o, and a maintenance
headache every time I want to make a significant change (e.g. switching
from Python 2.6 to Python 2.7, as I did recently).</p>
<p>This maintenance headache makes me want to just throw it all away and start
again. I'd make it leaner - Kal&#233;o's full of cruft that seemed like a good
idea at the time. I'd use the sites framework, so I could more easily manage
upgrades, and be able to spin up new sites quicker. I'd probably separate out
parts of it into apps, so other people could use just the parts of it they
need. I'd write better tests.</p>
<h1>Why I don't</h1>
<p>But then I remember that most of this code just works, and there's a better way
to do it. I can add tests for what I've already got. I can gradually pull apart
the dependencies I've got, and spin off parts of it into separate places. I can
get to where I want eventually, piece by piece.</p>
<blockquote>
<p>Programmers are, in their hearts, architects, and the first thing they want
to do when they get to a site is to bulldoze the place flat and build
something grand. We're not excited by incremental renovation: tinkering,
improving, planting flower beds.
&mdash; <cite><a href="http://www.joelonsoftware.com/articles/fog0000000069.html" title="Read Joel's article on throwing things away">Joel Spolsky: "Things you should never do"</a></cite></p>
</blockquote>
<p>So tiny step by tiny step I'm getting my code to a better place, tiny refactor
by tiny refactor, and I'm doing it all without breaking anything (much).</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Some software I wrote for managing Church websites, which I'll write
  about another time.&#160;<a href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>This is where I should probably be using something like <a href="http://fabfile.org">Fabric</a>,
  but I haven't got around to it yet.&#160;<a href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>There's probably a better way of doing this - I'm using <code>pip</code> and have a <code>requirements.txt</code>
  file, but I don't want to re-install everything, I just want to install
  the things I haven't got installed.&#160;<a href="#fnref:3" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>
        </div><!-- /.entry-content -->
        

</article>
</section>

        <section id="extras" class="body">
        
        
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://dominicrodger.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            

                        
                            <li><a href="http://twitter.com/dominicrodger">twitter</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                Site hosted by <a href="http://www.webfaction.com?affiliate=dominicrodger" title="Get hosted by WebFaction">WebFaction</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-11204085-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>



</body>
</html>