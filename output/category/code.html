<!DOCTYPE html>
<html lang="en">
<head>
        <title>dominicrodger.com - code</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
        <link href="http://dominicrodger.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="dominicrodger.com Atom Feed" />
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
                <script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

<a href="https://github.com/dominicrodger/dominicrodger.com">

<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />

</a>

        <header id="banner" class="body">
                <h1><a href="../.">dominicrodger.com </a></h1>
                <nav><ul>
                
                
                
                    <li><a href=".././pages/about-me.html">about me</a></li>
                
                
                
                    <li class="active"><a href=".././category/code.html">code</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                

            

        
        
            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href=".././build-breaking.html">Travis, You Are Awesome</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-04-29T12:27:00">
                Sunday 29 April 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/dominic-rodger.html">Dominic Rodger</a>
        </address>
        
<p>In <a href=".././category/code.html">code</a>. </p>



</footer><!-- /.post-info --><p>I came across <a href="http://travis-ci.org" title="Find out about Travis CI">Travis CI</a> this week, and it's awesome.</p>
<p>I've got a bunch of tests for <a href="https://github.com/dominicrodger/django-magazine" title="View django-magazine on GitHub">django-magazine</a>, but
I'm not very good at running them. It turns out that unit tests aren't
very useful if you don't run them, so I wanted to make sure that every
time I pushed code to it, the tests run. Enter Travis CI.</p>
<h2>Easy Unit Testing for Reusable Apps</h2>
<p>django-magazine is a reusable app - that is, it doesn't ship with
settings files, so you can't run its tests just after installing
it<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>.</p>
<p>I wasn't sure what the easiest way to handle this was, so I looked
around for Django reusable apps that were already using Travis, and
stumbled across <a href="https://github.com/stephenmcd/django-forms-builder" title="View django-forms-builder on GitHub">django-forms-builder</a>. They'd
solved this by adding an <code>example_project</code> folder, which had a simple
settings file, a urls file and a <code>manage.py</code><sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>.</p>
<p>That allows me to run the tests without any extra set-up, though I
still haven't worked out how to allow people who've just installed
from pip<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup> to run the tests right out of the box.</p>
<h2>.travis.yml</h2>
<p>There are just two things you need to do to get Travis CI working for
your project.</p>
<p>Firstly - sign in on their website. There's a slightly scary message
about giving it write access to your repositories, but there's a
decent enough reason on the Travis site explaining why they need
it<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>.</p>
<p>Secondly - add a .travis.yml file to your root directory, commit, and
push to GitHub. Travis CI will pick up your change, and start
building. <a href="https://github.com/dominicrodger/django-magazine/blob/28086f124e6752bad9f78466739673871adb5242/.travis.yml" title="View my .travis.yml file for django-magazine">My file</a> currently looks like this:</p>
<div class="codehilite"><pre><span class="l-Scalar-Plain">language</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">python</span>
<span class="l-Scalar-Plain">python</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="s">&quot;2.6&quot;</span>
  <span class="p-Indicator">-</span> <span class="s">&quot;2.7&quot;</span>
<span class="l-Scalar-Plain">env</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">DJANGO=1.3.1</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">DJANGO=1.4</span>
<span class="l-Scalar-Plain">install</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pip install -q Django==$DJANGO --use-mirrors</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pip install -r requirements.txt --use-mirrors</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pip install pep8</span>
<span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pep8 --exclude=migrations magazine</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">./magazine/example_project/manage.py test magazine</span>
</pre></div>


<p>This will kick off four builds:</p>
<ol>
<li>Python 2.6 and Django 1.3.1;</li>
<li>Python 2.6 and Django 1.4;</li>
<li>Python 2.7 and Django 1.3.1;</li>
<li>Python 2.7 and Django 1.4.</li>
</ol>
<p>Each of those will run in parallel, and you'll then get an e-mail with
the status of your build, if it changed (pleasingly, it doesn't e-mail
you for every build - open if the status of it has switched between
fixed and broken).</p>
<p>The <code>--use-mirrors</code> stuff is an attempt to help Travis CI avoid
overloading PyPI.</p>
<h2>Bonus Points: PEP-8</h2>
<p>I've recently discovered PEP-8, which I half knew about, but I'd never
attempted to make my code meet it. Then <a href="https://github.com/joshuajonah/django-magazine" title="View Joshua Jonah's fork of django-magazine">someone forked</a>
django-magazine to make it meet PEP-8, and I was shamed into fixing
it. I've added a line to my <code>.travis.yml</code> file so the build fails if
checked-in code is not PEP-8 friendly.</p>
<h2>Advertise Your Status</h2>
<p>Travis CI even provides an image that'll show your current build
status - adding it to my <code>README.md</code> file allows me to advertise that
(and implicitly, that I'm a bit obsessive) using:</p>
<div class="codehilite"><pre><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">secure</span><span class="p">.</span><span class="n">travis</span><span class="o">-</span><span class="n">ci</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">dominicrodger</span><span class="o">/</span><span class="n">django</span><span class="o">-</span><span class="n">magazine</span><span class="p">.</span><span class="n">png</span>?<span class="n">branch</span><span class="p">=</span><span class="n">master</span>
</pre></div>


<p>Currently, that looks like: <a href="http://travis-ci.org/dominicrodger/django-magazine"><img alt="Build Status" src="https://secure.travis-ci.org/dominicrodger/django-magazine.png?branch=master" /></a></p>
<p>All this is to say, Travis CI is awesome, and you should use it.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>This is probably a good time to point out that django-magazine
  is not available on PyPI yet. I've never added anything to PyPI
  before, and there's a couple of things I'd like to sort out
  before doing that.  Firstly I'd like to make sure I've tagged
  things properly, and secondly I need to factor out the book
  review stuff which is currently not tested, and is very specific
  to my particular use case.&#160;<a href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>They all had a <code>templates</code> folder, with a base template, which
  django-magazine doesn't need. That might be because I've done
  something wrong (every template extends
<br />
<code>magazine/magazine_base.html</code>, which doesn't have much in the
  way of HTML, but enough that all the tests pass, one of these
  days I should probably give it some simple styles).&#160;<a href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>As opposed to <code>git clone</code>, which is what Travis CI does, which
  means that the <code>example_project</code> code is in a predictable
  location (also, I've not yet added <code>example_project</code> to my
  manifest file, so it's not installed by pip).&#160;<a href="#fnref:3" rev="footnote" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>I'd love there to be a workaround for this, but Travis is
  awesome enough that I mostly just don't care.&#160;<a href="#fnref:4" rev="footnote" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                </article>
                
            </aside><!-- /#featured -->
            
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
            
        
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                        <h1><a href=".././nothing.html" rel="bookmark" title="Permalink to I Know Nothing">I Know Nothing</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-04-20T22:52:00">
                Friday 20 April 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/dominic-rodger.html">Dominic Rodger</a>
        </address>
        
<p>In <a href=".././category/code.html">code</a>. </p>



</footer><!-- /.post-info -->
                <blockquote>
<p>See, I know nothing! &mdash; <a href="http://www.imdb.com/character/ch0023128/quotes" title="Manuel, from Fawlty Towers">Manuel</a></p>
</blockquote>
<p>I distinctly remember being 17 years old, I'd just finished
re-launching a site for <a href="http://www.oxygen-online.org" title="Find out about Oxygen">a charity</a> I was involved with<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>,
and I confidently declared that I knew all there was to know about
building websites. And I believed it.</p>
<p>At the time, I ...</p>
                <a class="readmore" href=".././nothing.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                        <h1><a href=".././better-testing.html" rel="bookmark" title="Permalink to Getting Better at Testing">Getting Better at Testing</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-04-12T19:18:00">
                Thursday 12 April 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/dominic-rodger.html">Dominic Rodger</a>
        </address>
        
<p>In <a href=".././category/code.html">code</a>. </p>



</footer><!-- /.post-info -->
                <p>I started with unit testing about 4 years ago. I started writing what were
probably integration tests, when I was working on the database backend of our
application. The tests I wrote were designed to make sure that our process
which saved data actually saved data. Saving data involved creating ...</p>
                <a class="readmore" href=".././better-testing.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                        <h1><a href=".././pelican.html" rel="bookmark" title="Permalink to Starting with Pelican">Starting with Pelican</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-04-07T09:39:00">
                Saturday 07 April 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/dominic-rodger.html">Dominic Rodger</a>
        </address>
        
<p>In <a href=".././category/code.html">code</a>. </p>



</footer><!-- /.post-info -->
                <h1>A brief history of my (failed) blogs</h1>
<p>In about 1998, I was building a website for a friend. The site was entirely
static. I'd already learned the hard way about the pain of trying to keep lots
of separate static HTML files visually consistent.</p>
<p>To build the site, I ...</p>
                <a class="readmore" href=".././pelican.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                        <h1><a href=".././starting-over.html" rel="bookmark" title="Permalink to Starting Over">Starting Over</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-04-07T07:58:00">
                Saturday 07 April 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/dominic-rodger.html">Dominic Rodger</a>
        </address>
        
<p>In <a href=".././category/code.html">code</a>. </p>



</footer><!-- /.post-info -->
                <h1>Please sir, can I start again?</h1>
<p>Every once in a while, I want to start again.</p>
<p>I currently have 6 different sites using Kal&#233;o<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. The code is stored in
a private git repository, and synced out to 6 different places every time I
need to make a change ...</p>
                <a class="readmore" href=".././starting-over.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                        <h1><a href=".././tdd-django-south.html" rel="bookmark" title="Permalink to Test-Driven Development with Django & South">Test-Driven Development with Django & South</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-01-11T00:00:00">
                Tuesday 11 January 2011
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/dominic-rodger.html">Dominic Rodger</a>
        </address>
        
<p>In <a href=".././category/code.html">code</a>. </p>



</footer><!-- /.post-info -->
                <p>I'd basically given up on attempting test-driven with Django, given
the project I'm currently working on uses models with a lot of
<a href="http://south.aeracode.org" title="Find out about South, a tool for managing database migrations in Django.">South</a> migrations. Just building the database and running the
migrations could take a minute or so when running <code>manage.py test</code>,
and resetting the database to ...</p>
                <a class="readmore" href=".././tdd-django-south.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
            
        
        
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        
    


        <section id="extras" class="body">
        
        
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://dominicrodger.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            

                        
                            <li><a href="http://twitter.com/dominicrodger">Twitter</a></li>
                        
                            <li><a href="http://github.com/dominicrodger">GitHub</a></li>
                        
                            <li><a href="http://stackoverflow.com/users/20972/dominic-rodger">Stack Overflow</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                Site hosted by <a href="http://www.webfaction.com?affiliate=dominicrodger" title="Get hosted by WebFaction">WebFaction</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-11204085-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>



</body>
</html>